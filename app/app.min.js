angular.module("Roadmap",[]),angular.module("Roadmap").controller("MainController",["$scope","apiService","$timeout","$rootScope",function(a,b,c,d){a.init=function(b){a.lists=b,a.colors=["blue","orange","purple","green"],localStorage.auth&&(a.auth=!0)},a.authenticate=function(b){"guatemalaisthebest"==b?(a.auth=!0,localStorage.auth=!0,alertify.success("Welcome!")):alertify.error("HAHAHA! You got it wrong!")},a.createTask=function(c,d,e){b.createTask(c,d).then(function(b){a.newTask="",a.lists[e].tasks.push(b.data)})["catch"](function(a){console.error(a)})},a.createList=function(c){b.createList(c).then(function(b){a.lists.push(b.data)})["catch"](function(a){console.error(a)})},a.enableNewList=function(){a.newListEnabled=!0,c(function(){$("#new-list").focus()})},a.activateTask=function(b){a.modalOpen=!0,b.start=new Date(b.start),b.end=new Date(b.end),a.active=b},a.closeModal=function(){a.modalOpen=!1,a.editMode=!1},a.toggleEditMode=function(){a.editMode=!a.editMode},a.updateActive=function(c){a.editMode=!1,b.updateActive(c).then(function(a){d.$emit("task updated",a.data),alertify.success("Successfully updated your story.")})["catch"](function(a){console.error(a),alertify.error("Ooops! There was an error.")})},a.deleteTask=function(a){alertify.confirm("Are you sure you want to delete this task?",function(){b.deleteTask(a._id).then(function(a){alertify.success("Task successfully removed.")})["catch"](function(a){console.error(a),alertify.error("There was a problem with your request.")})})},d.$on("timeline task clicked",function(b,c){a.activateTask(c),a.$digest()})}]),angular.module("Roadmap").factory("apiService",["$http",function(a){var b={};return b.createTask=function(b,c){var d={list_id:c,content:b};return a.post("/api/task",d)},b.createList=function(b){return a.post("/api/list",{title:b})},b.updateActive=function(b){return a.put("/api/task/"+b._id,b)},b.deleteTask=function(b){return a["delete"]("/api/task/"+b)},b}]),angular.module("Roadmap").directive("timeline",["$rootScope",function(a){return{restrict:"A",scope:{lists:"="},link:function(b,c,d){var e=["blue","orange","purple","green"],f=b.lists.map(function(a){return{id:a._id,content:a.title}}),g=[];b.lists.forEach(function(a,b){a.tasks.forEach(function(c){if(c.start)return c.className=e[b],c.id=c._id,c.title=c.content,c.group=a._id,g.push(c)})});var h=document.getElementById("visualization"),i=new vis.DataSet(g),j={max:new Date(2017,11,31),min:new Date(2017,0,1),zoomMax:31556952e3,zoomMin:12096e5},k=new vis.Timeline(h,i,f,j);k.on("click",function(b){var c=b.item;c&&a.$emit("timeline task clicked",k.itemsData._data[c])}),a.$on("task updated",function(a,b){g=g.map(function(a){return a._id===b._id?b:a}).filter(function(a){return!!a.start}),i=new vis.DataSet(g),k.destroy(),k=new vis.Timeline(h,i,j)})}}}]);